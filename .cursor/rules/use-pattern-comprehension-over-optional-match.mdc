---
description: 
globs: 
alwaysApply: false
---

# Use pattern comprehension over optional match

When generating cypher, avoid OPTIONAL MATCH and use pattern comprehensions instead.

Do not write:

```
MATCH (u:User)
OPTIONAL MATCH (u)-[:HAS_ENROLMENT]->(e)
RETURN u AS user, collect(e) AS enrolments
```

Instead, write:

```
MATCH (u:User)
RETURN u AS user, [ (u)-[:HAS_ENROLMENT]->(e) | e ] AS enrolments
``` 
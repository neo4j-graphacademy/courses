= Consuming results
:type: challenge
:sandbox: ide?lang=python
:minutes: 10
:order: 2

You are working on an application that uses Neo4j to calculate the cheapest flights between two cities.  

Users are complaining that the results are not always available immediately.
The application uses Server-sent events to stream results to the client.


[source,python,role="ide"]
----
from api import send_to_ui 

def find_cheapest_flights(tx, date, origin, destination):
    result = tx.run("""
        MATCH (origin:Airport)<-[:ORIGIN]-(f:Flight)-[:DESTINATION]->(destination:Airport),
            (f)-[:OPERATED_BY]->(operator:Airline)
        WHERE origin.name = $origin AND destination.name = $destination AND f.date = $date
        RETURN f.price AS price, operator.name AS operator
    """, date=date, origin=origin, destination=destination)
    return result.values()
----
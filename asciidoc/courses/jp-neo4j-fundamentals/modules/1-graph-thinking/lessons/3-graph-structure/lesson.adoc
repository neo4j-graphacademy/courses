= グラフの構造
// :type: video
:type: quiz
:order: 3

// [.video]
// video::cj8N1VaKtV8[youtube,width=560,height=315]

[.transcript]
== グラフの性質とトラバース

グラフの特性にはいくつかの種類があります。
また、さまざまな質問に答えるためにグラフをトラバースする方法も数多くあります。

=== 有向グラフと無向グラフ

image::images/michael-sarah-undirected.jpg[Michael and Sarah are married to each other, role=right]

無向グラフでは、リレーションシップは双方向または対称とみなされます。

無向グラフの例として、結婚の概念があります。
MichaelとSarahが結婚していれば、SarahもMichaelと結婚していると考えることができます。

有向グラフは、グラフにさらに情報の次元を追加することになります。
同じタイプで反対方向にあるリレーションシップは、異なる意味合いを持ちます。

image::images/michael-sarah-directed.jpg[Michael and Sarah have different strengths of their love, role=left]

例えば、結婚が左右対称の関係だとしたら、愛の概念は左右非対称です。
二人が互いに好きであったり、愛していたりしても、その量には大きな差があります。
方向性のあるリレーションシップは、多くの場合、何らかの重み付けで修飾することができます。
ここでは、LOVESリレーションシップの強さが、ある人が他の人をどれだけ愛しているかを表していることがわかります。

より大きなスケールでは、社会的なつながりの大規模ネットワークは、ネットワーク効果を理解し、情報や病気の伝搬を予測するために使用することもできる。
人と人とのつながりの強さがあれば、情報がネットワークを通じてどのように広がるかを予測することができるようになります。

=== 重み付きグラフと重み無しグラフの比較

愛の概念もまた、重み付きグラフの一例です。

重み付きグラフでは、ノード間のリレーションシップは、例えばコスト、時間、距離、優先度など、様々な尺度を表す値を持ちます。

基本的な最短経路アルゴリズムでは、グラフ内の2つのノード間の最短距離を計算します。近所の店までの最短の徒歩ルートを見つけたり、都市から都市への移動に最も効率的なルートを計算したりするのに役立ちます。

image::images/roads.jpg[Roads between cities]

この例では、このグラフに対して、次のような質問が考えられます。

「スプリングフィールドからセンタービルへの最短のドライブは何ですか？」

_HAS_ROAD_ のリレーションシップとその距離を用いると、Springfieldから出発し、Cliffside、Newtownと進み、最後にCentervilleに到着するのが最短のドライブとなることがわかります。

より複雑な最短経路アルゴリズム（例えば、ダイクストラアルゴリズムやA-Star探索アルゴリズム）では、最短経路を計算する際にリレーションシップの重み付け特性を考慮します。

例えば、国際宅急便で荷物を送る場合、早く届くように空路で送りたいとします。その場合、ある地点から次の地点まで行くのにかかる時間を重み付けとして考慮することになります。

逆に、コストが問題であれば、船便で荷物を送ることを考える可能性もあります。その場合は、荷物を送るコストを表すプロパティを使うことになります。

=== グラフのトラバーサル

グラフのデータに関する質問に答えるには、グラフをトラバース（走査）するのが一般的です。SpringfieldとCentervilleの間の最短経路を求めるには、2つの都市間のすべての経路をトラバースして最短経路を求める必要があります。

* Springfield - Newtown - Centerville = 26
* Springfield - Cliffside - Newtown - Centerville = 23
* Springfield - Cliffside - Melrose - Centerville = 49

トラバースは、グラフの中でリレーションシップをたどることを意味します。
グラフ理論には、アプリケーションの性能に影響を与える様々なタイプのトラバースがあります。
例えば、リレーションシップを複数回トラバースすることができるか、ノードを複数回訪問することができるか、などです。

Neo4jのCypherステートメント言語は、ノード・トラバースに最適化されているので、リレーションシップが何度もトラバースされることはなく、アプリケーションにとって大きなパフォーマンスの向上となります。

== 理解度チェック

include::questions/1-traversal.adoc[leveloffset=+1]

[.summary]

== まとめ

このレッスンでは、グラフの構成や、リレーションシップが方向と重みを持つことができることを学びました。
次に、グラフの一般的な使用例について学びます。

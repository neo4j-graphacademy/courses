= Creating Relationships
:type: lesson
:order: 4

You learned how to import nodes and map their properties from CSV files.

In this lesson, you will create relationships between the Northwind nodes.

== Understanding Relationship Mapping

Relationships connect entities and make the graph useful for queries.

image::images/acted_in.svg[Relationship,width=400,align=center]

Relationships in Data Importer need:

// ```mermaid
// flowchart TD
//     A[Relationship] --> B[Type Name]
//     A --> C[Source Node]
//     A --> D[Target Node]
//     A --> E[Matching IDs]
//     A --> F[Properties optional]
// ```

1. **Type** - The relationship name (e.g., PLACED, ORDERS)
2. **Source** - Which node it starts from
3. **Target** - Which node it points to
4. **IDs** - How to match source and target nodes
5. **Properties** - Optional attributes on the relationship

== Relationship 1: Customer PLACED Order

```mermaid
graph LR
    A[Customer] -->|PLACED| B[Order]
```

This relationship connects customers to their orders.

### Creating the Relationship

1. Hover over the **Customer** node edge
2. Click the **+** button that appears
3. Drag to the **Order** node
4. A relationship line appears

### Configure the Relationship

In the details panel:

* **Type**: `PLACED`
* **From file**: `orders.csv`
* **From ID**: Match `customerID` from CSV to `customerId` property
* **To ID**: Match `orderID` from CSV to `orderId` property

// ```mermaid
// flowchart LR
//     A["orders.csv<br/>customerID: ALFKI<br/>orderID: 10248"] --> B[Match]
//     B --> C[Customer: ALFKI]
//     B --> D[Order: 10248]
//     C -->|PLACED| D
// ```

No properties needed on this relationship.

== Relationship 2: Product PART_OF Category

```mermaid
graph LR
    A[Product] -->|PART_OF| B[Category]
```

### Creating the Relationship

1. Drag from **Product** node to **Category** node
2. Set type to `PART_OF`
3. **From file**: `products.csv`
4. **From ID**: Match `productID` to `productId`
5. **To ID**: Match `categoryID` to `categoryId`

== Relationship 3: Product SUPPLIED_BY Supplier

```mermaid
graph LR
    A[Product] -->|SUPPLIED_BY| B[Supplier]
```

### Creating the Relationship

1. Drag from **Product** node to **Supplier** node
2. Set type to `SUPPLIED_BY`
3. **From file**: `products.csv`
4. **From ID**: Match `productID` to `productId`
5. **To ID**: Match `supplierID` to `supplierId`

== Relationship 4: Order ORDERS Product (with Properties)

```mermaid
graph LR
    A[Order] -->|"ORDERS<br/>quantity<br/>unitPrice<br/>discount"| B[Product]
```

This relationship is special because it has properties: quantity, unit price, and discount.

### The Order Details CSV

For this relationship, we need the `order-details.csv` file:

* Download: link:https://data.neo4j.com/northwind/order-details.csv[order-details.csv^]
* Upload it to Data Importer

### Creating the Relationship

1. Drag from **Order** node to **Product** node
2. Set type to `ORDERS`
3. **From file**: `order-details.csv`
4. **From ID**: Match `orderID` to `orderId`
5. **To ID**: Match `productID` to `productId`

### Add Relationship Properties

In the details panel, add these properties:

| CSV Column | Property | Type |
|------------|----------|------|
| quantity | quantity | Integer |
| unitPrice | unitPrice | Float |
| discount | discount | Float |

```mermaid
graph LR
    A[Order: 10248] -->|"ORDERS<br/>quantity: 12<br/>unitPrice: 18.00<br/>discount: 0.0"| B[Product: Chai]
```

== Relationship 5: Employee SOLD Order

```mermaid
graph LR
    A[Employee] -->|SOLD| B[Order]
```

### Creating the Relationship

1. Drag from **Employee** node to **Order** node
2. Set type to `SOLD`
3. **From file**: `orders.csv`
4. **From ID**: Match `employeeID` to `employeeId`
5. **To ID**: Match `orderID` to `orderId`

== Relationship 6: Employee REPORTS_TO Employee

```mermaid
graph LR
    A[Employee] -->|REPORTS_TO| B[Employee]
```

This is a **self-referencing relationship** - employees report to other employees.

### Creating the Relationship

1. Drag from **Employee** node back to itself
2. Set type to `REPORTS_TO`
3. **From file**: `employees.csv`
4. **From ID**: Match `employeeID` to `employeeId`
5. **To ID**: Match `reportsTo` to `employeeId`

[NOTE]
====
The `employees.csv` file has a `reportsTo` column containing the ID of the manager. This creates the hierarchy.
====

== Complete Data Model

Your canvas should now show the complete Northwind graph model:

```mermaid
graph TB
    Customer[Customer] -->|PLACED| Order[Order]
    Order -->|ORDERS| Product[Product]
    Product -->|PART_OF| Category[Category]
    Product -->|SUPPLIED_BY| Supplier[Supplier]
    Employee[Employee] -->|SOLD| Order
    Employee -->|REPORTS_TO| Employee
```

All relationships should have:
* ✓ Type names set
* ✓ Source/target nodes connected
* ✓ CSV files assigned
* ✓ ID mappings configured
* ✓ Properties mapped (for ORDERS relationship)

== Summary

In this lesson, you:

* Created all six relationships for the Northwind graph
* Connected Customer to Order with PLACED
* Connected Product to Category with PART_OF
* Connected Product to Supplier with SUPPLIED_BY
* Connected Order to Product with ORDERS (with properties)
* Connected Employee to Order with SOLD
* Connected Employee to Employee with REPORTS_TO

In the next lesson, you will add constraints and indexes before running the import.

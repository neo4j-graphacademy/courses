= Text to Cypher retriever
:type: lesson
:order: 2
:branch: main


The `Text2CypherRetriever` retriever allows you to create `GraphRAG` pipelines that can answer natural language questions by generating and executing Cypher queries against the knowledge graph.

Using text to cypher retrieval can help you get precise information from the knowledge graph based on user questions. For example, how many lessons are in a course, what concepts are covered in a module, or how technologies relate to each other.

== Create a Text2CypherRetriever GraphRAG pipeline

Open `genai-graphrag-python/text2cypher_rag.py` and review the code.

[source, python]
----
include::{repository-raw}/{branch}/genai-graphrag-python/text2cypher_rag.py[]
----

The retriever is configured to use your database connection and given an example of how to query nodes by name:

[source, python]
----
include::{repository-raw}/{branch}/genai-graphrag-python/solutions/text2cypher_rag.py[tag=examples]

include::{repository-raw}/{branch}/genai-graphrag-python/solutions/text2cypher_rag.py[tag=retriever]
----

The response includes the Cypher statement that the LLM generated and the results from executing the query:

[source, python]
----
include::{repository-raw}/{branch}/genai-graphrag-python/solutions/text2cypher_rag.py[tag=print_response]
----

Running the code for the query, _"How many technologies are mentioned in the knowledge graph?"_, will produce a response similar to:

_114 technologies are mentioned in the knowledge graph._

The context shows that the LLM generated and executed the following Cypher query:

[source, cypher]
----
MATCH (t:Technology) RETURN count(t) AS technologyCount
----

The following data was returned from the knowledge graph and passed as context to the LLM:

[source, python]
----
[RetrieverResultItem(content='<Record technologyCount=114>', metadata=None)]
----

== Experiment with Different Questions

The `Text2CypherRetriever` passed the graph schema to the LLM to help it generate accurate Cypher queries.

Try asking different questions about the knowledge graph such as:

* _How does Neo4j relate to other technologies?_
* _What entities exist in the knowledge graph?_
* _Which lessons cover Generative AI concepts?_

Review the responses, the generated Cypher queries, and the results passed to the LLM.

[.quiz]
== Check your understanding

include::questions/1-text2cypher.adoc[leveloffset=+2]

[.summary]
== Lesson Summary

In this lesson, you:

* Created a `GraphRAG` pipeline using the `Text2CypherRetriever`.
* Used natural language questions to generate and execute Cypher queries against the knowledge graph.

In the next module you will explore how to customize the `SimpleKGPipeline` to create knowledge graphs for different types of data, scenarios, and use cases.

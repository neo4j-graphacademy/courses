= Retrievers
:order: 1
:type: lesson
:slides: true

[.slide.discrete]
== Retrievers

link:https://python.langchain.com/docs/modules/data_connection/retrievers/[Retrievers^] are LangChain chain components that allow you to retrieve documents using an unstructured query.

    Find financial documents about quarterly earnings performance.

Documents are any unstructured text that you want to retrieve. 
A retriever often uses a vector store as its underlying data structure.

Retrievers are a key component for creating models that can take advantage of Retrieval Augmented Generation (RAG).

In the previous workshop, you used a vector index of financial documents - in this example, the financial reports are the _documents_, and you can use a _retriever_ to give a model context.

[.slide]
== Neo4jVector

The link:https://python.langchain.com/docs/integrations/vectorstores/neo4jvector[`Neo4jVector`^] is a LangChain vector store that uses a Neo4j database as the underlying data structure.

You used the `Neo4jVector` to generate embeddings, store them in the database, and retrieve them.
You can also use the `Neo4jVector` to query a vector index.

Open the `financial_retriever.py` file and review the code.

[.transcript-only]
====
[source,python]
----
from langchain_neo4j import Neo4jVector
from langchain_openai import OpenAIEmbeddings

# Create vector store from existing index
vector = Neo4jVector.from_existing_index(
    embedding=OpenAIEmbeddings(),
    url="bolt://localhost:7687",
    username="neo4j",
    password="password",
    index_name="financial_embeddings",
    node_label="Document",
    text_node_property="content",
    embedding_node_property="embedding"
)

# Search for similar documents
query = "quarterly earnings performance"
docs = vector.similarity_search(query)

for doc in docs:
    print(f"Title: {doc.metadata['title']}")
    print(f"Content: {doc.page_content[:200]}...")
    print("---")
----
====

The program creates a `Neo4jVector` from the `financial_embeddings` vector index and uses the `similarity_search()` method to retrieve the financial documents as documents.

[.slide.discrete]
== Similarity search

The `similarity_search()` method returns a list of link:https://api.python.langchain.com/en/latest/documents/langchain_core.documents.base.Document.html[`Document`^] objects. The `Document` object includes the properties:

* `page_content` - the content referenced by the index, in this example the content of the financial document
* `metadata` - a dictionary of the `Document` node properties returned by the index

[TIP]
.Specify the number of documents
====
You can pass an optional `k` argument to the `similarity_search()` method to specify the number of documents to return. The default is 4.

[source,python]
----
vector.similarity_search(query, k=1)
----
====

Retrievers and vector indexes allow you to incorporate unstructured data into your LangChain applications.

== Questions

Answer the following questions about retrievers and vector search:

1. **Question**: What does the `similarity_search()` method return?
   
   **Answer**: A list of `Document` objects containing `page_content` (the retrieved text) and `metadata` (node properties from the index).

2. **Question**: How do you specify the number of documents to return from a vector search?
   
   **Answer**: Use the optional `k` parameter: `vector.similarity_search(query, k=5)`

3. **Question**: What is the main purpose of a retriever in RAG applications?
   
   **Answer**: To find and retrieve relevant documents that provide context to enhance LLM responses with accurate, up-to-date information.

4. **Question**: What properties does a Neo4jVector need to query an existing index?
   
   **Answer**: The index name, node label, text node property, embedding node property, and database connection details.

[.next]
== Continue

When you are ready, you can move on to the next task.

read::Move on[]

[.summary]
== Lesson Summary

You learned about retrievers and how they can use Neo4j vectors to retrieve documents for RAG applications.

Next you will add a retriever chain to enhance responses with relevant context.
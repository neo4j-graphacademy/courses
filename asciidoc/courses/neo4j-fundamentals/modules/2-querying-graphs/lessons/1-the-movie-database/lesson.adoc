= The Movie Graph
:order: 1
:sandbox: true

GraphAcademy has created a Neo4j sandbox instance for you to explore.

The graph database contains: 

* Movies, actors and directors from link:https://www.themoviedb.org/[The Movie Database (TMDB)^].
* Movie ratings by users of the website.

The graph is structure with the following nodes and relationships:

image::./images/schema-simple.svg[The graph schema, showing Person, Movie, Genre and User nodes connected by ACTED_IN, DIRECTED, IN_GENRE and RATED relationships.]

== People

The graph contains 19047 nodes with a `:Person` label.
Each of these may have one or more outgoing `:ACTED_IN` and `:DIRECTED` relationships to a node with the label `:Movie`.

Each `Person` node has an unique `name` property, as well as other properties such as `bio` and `born`.`

Run the following Cypher statement to find a `Person` node with the `name` attribute 'Tom Hanks'.

[source,cypher]
.Tom Hanks
----
MATCH (n:Person)
WHERE n.name = 'Tom Hanks'
RETURN n
----

image:images/tom-hanks.png[The result of the above query showing a single node labelled Tom Hanks]

You can view the node properties by selecting the node. 

You can expand a node's relationships by doubling click the node.

image:images/tom-hanks-rels.svg[The Tom Hanks node connected to Movie nodes with ACTED_IN relationships]

== Movies

Each `Movie` node has a `title` property, and may contain a number of other properties including `plot`, `released` and `url` which contains a link to its page on link:https://www.themoviedb.org/[TMDB^].

Run the following Cypher statement to find the movie 'Toy Story' and the people who acted in the movie.

[source,cypher]
----
MATCH (m:Movie)<-[r:ACTED_IN]->(p:Person)
WHERE m.title = 'Toy Story'
RETURN m, r, p
----

image:images/toy-story-actors.svg[The results of the query showing the Toy Story movie node and Person nodes connected by ACTED_IN relationships]

Movies are categorized into one or more genres.
For example, Toy Story is categorized as Adventure, Animation, Children, Comedy and Fantasy.

[source,cypher]
.Movie Genres
----
MATCH (m:Movie)-[r:IN_GENRE]->(g:Genre)
WHERE m.title = 'Toy Story'
RETURN m, r, g
----

Experiment with these queries. Try and find different films and actors.

== User Ratings

The graph contains 671 users and over 100k ratings.

[source,cypher]
----
MATCH (u:User)-[r:RATED]->(m:Movie)
WHERE u.name = "Mr. Jason Love"
RETURN u, r, m
----

The **rating** the user has given for the movie is stored as a property on the `RATED` relationship.

image::images/ratings.png[Graph of ratings for Mr Love]

You can return tabular data by returning the properties of the nodes.

[source,cypher]
----
MATCH (u:User)-[r:RATED]->(m:Movie)
WHERE u.name = "Mr. Jason Love"
RETURN u.name, r.rating, m.title
----

You will learn more about querying graphs using Cypher in GraphAcademy course link:/courses/cypher-fundamentals[Cypher Fundamentals^].

[TIP]
====
You can view the database schema by running the following Cypher statement in the integrated query window to the right.

[source,cypher]
----
CALL db.schema.visualization()
----

This is a built-in procedure that examines the database and returns the labels, relationship types and properties held in the database.

You may notice that the `:Actor` and `:Director` nodes in the visualization have the same relationship types.

For the purpose of the visualization, these are treated as different nodes but in the context of the database a `Person` can an `Actor`, `Director`, or both.

This is an example of using multiple labels on a single node.
====

== Check Your Understanding

include::./questions/1-nodes.adoc[leveloffset=+1]

[.summary]
== Summary

In this lesson, you learned explored the nodes and relationships in the movie recommendations dataset.

In the next lesson, you will learn how to find patterns in the data using Cypher.

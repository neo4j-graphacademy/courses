=  Storage Emergency
:type: challenge
:order: 6


== Scenario

You receive an urgent alert at 11:45 PM on Saturday:

**"Storage at 95% capacity - Instance will become read-only at 100%"**

Checking the metrics:

* **Storage**: 475GB used of 500GB allocated (instance maximum)
* **Storage growth**: Jumped from 420GB to 475GB in the past 3 hours
* **Query rate**: Higher than normal for weekend (normally low on Saturday nights)

Looking at query logs from the past 3 hours, you see thousands of executions of:

----
CREATE (log:ActivityLog {
  timestamp: $timestamp,
  details: $details,
  stackTrace: $stackTrace
})
----

The `stackTrace` property contains large text blobs (10-50KB each).

This appears to be an error-logging mechanism that started logging excessively at 9:00 PM.


== The Challenge

What should you do to prevent the instance from becoming read-only?


include::questions/1-storage-emergency.adoc[leveloffset=+1]


[.summary]
== Summary

When storage is critically full due to unexpected data growth, you must act quickly to prevent the instance from becoming read-only.

The correct approach combines immediate data cleanup with fixing the root cause:

1. **Stop the excessive logging** - contact the on-call developer or disable the logging service
2. **Delete the problematic data** - remove the ActivityLog nodes created in the past 3 hours
3. **Monitor storage levels** - ensure storage decreases and stabilizes

**Why not just scale the instance?**

* Scaling takes time and doesn't stop the ongoing data creation
* If logging continues unchecked, you'll fill any size instance
* May be costly for temporary problem
* Should fix root cause first

**After the immediate crisis:**

* Implement proper log rotation and retention policies
* Consider alternative logging solutions (external log storage)
* Set up storage monitoring alerts at 80% capacity

Review what caused the excessive error logging

This scenario highlights the importance of monitoring storage trends and having data retention policies.


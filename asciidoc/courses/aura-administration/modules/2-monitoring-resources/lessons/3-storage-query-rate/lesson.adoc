= Storage and Query Rate
:type: lesson
:order: 5


[.discrete]
== Introduction

Storage and query rate metrics help you understand database growth and workload patterns.

In this lesson, you will learn how to monitor storage consumption and query rates to identify trends and plan for future capacity.


== Monitoring Storage

The Storage metric shows the total disk space used by your instance.

Storage is consumed by:

* Node and relationship data
* Property values
* Indexes (especially full-text and vector indexes)
* Transaction logs
* Backup data


=== Understanding Storage Growth

Monitor storage for:

* **Linear growth**: Steady data addition over time
* **Sudden jumps**: Large data imports or batch operations
* **Plateaus**: Stable data size
* **Storage reduction**: After data deletion or compaction

[NOTE]
.Allocated vs. used space
====
Storage metrics may show a difference between **allocated space** and **used space**.

This is normal and covered in detail in the Database monitoring module.
====


=== Storage Considerations by Data Type

Different data types have different storage impacts:

* **Nodes and relationships**: Relatively small
* **Properties**: Variable size based on data types
* **Long strings**: Can consume significant space
* **Vector embeddings**: Very storage-intensive (hundreds of bytes per vector)
* **Full-text indexes**: Additional storage for text analysis


=== When to Act on Storage

Consider action when:

* Storage growth is faster than expected
* Storage is approaching instance limits
* Large difference between allocated and used space (covered in Module 4)
* Storage costs are becoming significant


== Query Rate Metrics

The Query Rate metric shows the number of queries executed per minute.

This metric helps you understand:

* Workload intensity
* Usage patterns over time
* Impact of application changes
* Capacity requirements


=== Reading Query Rate Charts

The Query Rate chart displays:

* **Queries per minute**: Total query count
* **Rate over time**: Historical query patterns
* **Peak rates**: Maximum query load


=== Normal Query Rate Patterns

Typical patterns include:


==== Business Hours Pattern

* High query rates during business hours
* Low rates overnight and weekends
* Predictable daily cycles


==== Steady State

* Consistent query rate 24/7
* May indicate automated systems or global user base
* Easier to plan capacity


==== Batch Processing Pattern

* Low baseline with regular spikes
* Spikes correspond to scheduled jobs
* Requires capacity for peak loads


==== Growth Trend

* Gradually increasing query rates over weeks/months
* Indicates growing usage
* Requires capacity planning


== Correlating Storage and Query Rate

Understanding the relationship between storage and query rate helps you:

* **Predict performance**: Larger databases may need more resources for same query rate
* **Plan scaling**: Growing data and query volume both drive capacity needs
* **Optimize costs**: Balance instance size with actual usage patterns


=== Example Scenarios

**High query rate, stable storage**:

* Read-heavy workload
* May benefit from caching
* Page cache optimization is important


**Growing storage, stable query rate**:

* Write-heavy workload
* May need storage optimization
* Consider data archival strategies


**Both growing together**:

* Typical of growing application
* Proactive scaling needed
* Monitor trends closely


== Taking Action

Based on storage and query rate metrics:


=== For High Storage Growth

* Review data model for efficiency
* Identify and remove unnecessary data
* Implement data retention policies
* Consider database compaction
* Plan instance upgrades for additional capacity


=== For High Query Rates

* Optimize frequently executed queries
* Implement application-level caching
* Use connection pooling
* Consider read replicas (Business Critical tier)
* Scale instance for more resources


=== For Both

* Evaluate instance tier and size
* Implement comprehensive optimization strategy
* Plan for continued growth
* Consider architecture changes


[TIP]
.Setting up alerts
====
Set up monitoring alerts when storage or query rates exceed thresholds.

Use external monitoring tools (covered in Module 6) for automated alerting.
====


[.quiz]
== Check Your Understanding

include::questions/1-storage-query.adoc[leveloffset=+1]


[.summary]
== Summary

You learned how to monitor storage consumption and query rates for your Aura instances.

You learned to identify normal patterns, understand the relationship between metrics, and determine when action is needed.

In the next module, you will learn about instance-level performance metrics including memory usage, page cache, and garbage collection.


=  Memory Pressure
:type: challenge
:order: 2


== Scenario

Your production instance has been experiencing intermittent slowness for the past week.

Users report that "sometimes queries are fast, sometimes they take forever."

Reviewing the Instance metrics for the past 7 days, you observe:

* **Heap Memory Usage**: Consistently between 85-95%, with frequent spikes to 98%
* **Garbage Collection Total %**: 12% (was 2% last month)
* **Old Gen GC**: Occurring every 10-15 minutes (was hourly last month)
* **CPU Usage**: Normal, around 50% of capacity
* **Page Cache Hit Ratio**: Still at 99%

Query logs show that query execution times are highly variable:

* Same query might take 50ms or 5,000ms depending on when it runs
* No specific slow query pattern identified


== The Challenge

Based on these metrics, what's causing the intermittent slowness?


include::questions/1-heap-pressure.adoc[leveloffset=+1]


[.summary]
== Summary

High heap usage combined with excessive garbage collection causes intermittent slowness because GC pauses all query execution. Scale the instance to get more heap memory and reduce GC frequency

**The solution:**

1. **Immediate**: Scale instance to get more heap memory
2. **Investigate**: Review query patterns for memory-intensive operations
3. **Optimize**: Reduce memory usage through query optimization if possible

Heap usage should stay below 80% for consistent performance.

Even with good page cache hit ratio and normal CPU, excessive heap usage and GC will degrade performance significantly.


[.question]
= Compaction Cost-Benefit

After reviewing monthly metrics:

. Allocated: 180GB
. Used: 95GB
. Gap: 85GB (47% unused)

History shows allocated space grew from 120GB to 180GB while used space declined from 110GB to 95GB after a major data cleanup last month (2 million nodes deleted).

What should you do?

* [ ] Nothing - space will be automatically reclaimed

* [ ] Immediately scale down the instance

* [x] Schedule compaction during next maintenance window

* [ ] Wait until gap reaches 75% before acting

[TIP,role=hint]
.Hint
====
Consider the size of the gap, the cause (major deletion), and the appropriate timing for compaction.
====

[TIP,role=solution]
.Solution
====
**Schedule compaction during next maintenance window** is correct.

**Analysis**:

**The gap (47%)** is significant: Guideline suggests >30-40% gap justifies compaction, you have 85GB of unused storage, after major deletion space won't be reused efficiently, and storage costs are accumulating.

**Why compaction makes sense**: Major data cleanup (2M nodes deleted), large persistent gap, reduces from 180GB to ~100GB, saves 80GB of storage costs, and provides slight performance improvement.

**Why "during maintenance window"**: Compaction requires downtime (30min-2hours depending on size), it's an Export → Recreate → Import process, you should plan during low-usage period, and coordinate with stakeholders.

**Compaction process**:
1. Schedule maintenance window
2. Export database: `neo4j-admin database dump`
3. Create new instance or clear existing
4. Import dump: `neo4j-admin database load`
5. Verify data integrity
6. Resume operations

**After compaction**: Allocated space will be ~100GB (matches used), storage costs are reduced, and you have more efficient storage.

The other options: Space won't be automatically reclaimed after major deletions, you can't scale down with data still there, and 47% already warrants action (don't wait for 75%).

**Key decision factors**: Gap size is >40% (YES - 47%), it's after major deletion (YES), storage costs matter (YES), and you can schedule downtime (so schedule it).

**Result**: Compaction is justified, schedule it appropriately.
====


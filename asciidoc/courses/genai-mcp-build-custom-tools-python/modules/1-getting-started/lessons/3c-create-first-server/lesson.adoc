= Create Your First MCP Server 
:type: challenge
:order: 3

Now for a challenge!  So far you've learned about the MCP Python SDK and FastMCP, and set up your development environment.

Now it's time to put that knowledge into practice by creating your own MCP server from scratch.

Your challenge is to create a simple MCP server that demonstrates the core concepts you've learned, then run and test it using the tools you've set up.

[NOTE]
.GitHub Codespace
====
If you haven't completed the setup lesson yet, go back to link:../2-setup/[Setting Up Your Development Environment^] to configure your Codespace and environment variables.

You can keep the Codespace open while completing the course. 
You can open your existing codespaces at link:https://github.com/codespaces[github.com/codespaces^].
====


== Challenge Goals

To complete this challenge, you will need to:

1. Create a new MCP server using the MCP Python SDK.
2. Create a tool that counts the number of times a letter appears in a word.
3. Configure VS Code to use the MCP server with stdio.
4. Test the server using the Chat window in Agent mode.

== Step-by-Step Instructions

=== Step 1: Set up your project directory

First, create a new directory for your MCP server:

[source,bash]
----
mkdir strawberry
cd strawberry
----

=== Step 2: Initialize the project with uv

Initialize a new Python project using `uv`:

[source,bash]
----
uv init
----

This will create a basic project structure with a `pyproject.toml` file and a `main.py` file that you will use to build your MCP server.

=== Step 3: Add the MCP dependency

Add the MCP Python SDK to your project:

[source,bash]
----
uv add "mcp[cli]"
----

=== Step 4: Create your MCP server


Open `main.py` in your editor and add the following code to create a simple MCP server:

[source,python]
.main.py
----
from mcp.server.fastmcp import FastMCP

# Create an MCP server
mcp = FastMCP("Strawbrerry")

@mcp.tool()
def count_letters(text: str, search: str) -> int:
    """Count occurrences of a letter in the text"""
    return text.lower().count(search.lower()) 

# Run the server when executed directly
if __name__ == "__main__":
    mcp.run(transport="streaming-http")
----

[NOTE]
.Streaming HTTP
====
This example uses the `streaming-http` transport method to run the server.
This differs from `stdio` in that the client uses HTTP to communicate with the server.

We have made this choice to make it easier to test the server in GitHub Codespaces with the MCP Inspector.
For local development, using `stdio` is also a valid option.

link:https://modelcontextprotocol.io/specification/2025-06-18/basic/transports[Learn more about transports^]
====

=== Step 5: Configure your server in VS Code and test with Agent mode

Now let's configure your server to work with VS Code's Agent mode. This will allow you to interact with your MCP server through a conversational interface.

First, let's run the server to make sure it works:

[source,bash]
----
uv run main.py
----

If the server is running, you will see the following output in the terminal:

[source,role=nocopy]
.Console Output
----
INFO:     Started server process [30256]
INFO:     Waiting for application startup.
[10/15/25 12:52:22] INFO     StreamableHTTP session manager     streamable_http_manager.py:110
                             started                                                          
INFO:     Application startup complete.
INFO:     Uvicorn running on http://127.0.0.1:8000 (Press CTRL+C to quit)
----


Once the server is running, modify the `.vscode/mcp.json` file to configure VS Code to use the server.

[source,json]
----
{
    "servers": {
        "strawberry": {
            "type": "http",
            "url": "http://localhost:8000/mcp"
        }
    }
}
----

This configuration tells VS Code to connect to the server at `http://localhost:8000/mcp` using a HTTP connection.


=== Step 6: Verify your implementation


To test your server, open up the Chat window in **Agent** mode:

1. Open the Command Palette (`Cmd+Shift+P` or `Ctrl+Shift+P`)
2. Execute the "Chat: Open Chat (Agent)" command

Now try asking the following question:

[copy]#How many times does the letter 'r' appear in the word 'strawberry'?#

The agent should discover the `count_letters` tool and prompt you to confirm the tool call.
It should respond with the answer `3`.


[TIP]
.The agent didn't call the tool?
====
This is the joy of LLMs and tool calling.
Depending on the underlying model, the agent may not behave as you expect.  
In this case, the model may feel confident in its own answer and not call the tool.

Try switching to a different model, rephrasing the question, or explicitly mentioning the tool you want to use.
====



== That's it!

You have just created your first MCP server! 

The Chat window in VS Code is a useful way to test your server, but it isn't the most efficient way to test your MCP server.
In the next lesson, you will learn about the MCP Inspector, which is a tool that allows you to inspect the MCP server and its tools.


read::Mark as Completed[]

[.summary]
== Summary

In this challenge, you successfully built your first MCP server from scratch:

* **FastMCP setup** - Created a new MCP server using the FastMCP class with the MCP Python SDK
* **Tool implementation** - Added a `count_letters` tool using the `@mcp.tool()` decorator to solve LLM counting limitations.
* **Server installation** - Configured the server for VS Code using `uv run mcp install main.py`
* **Agent mode testing** - Tested the server functionality through VS Code Agent mode with conversational queries

In the next lesson, you will learn about context management for handling server lifecycle and resource management.
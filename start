#! /bin/sh

TMP_FOLDER=/tmp
TARGET_FOLDER=/app

# echo "Saving Google credentials..."
echo $GOOGLE_APPLICATION_CREDENTIALS_CONTENT >> $GOOGLE_APPLICATION_CREDENTIALS

for folder in "certifications" "courses" "html"
do
   echo "Downloading $folder"

   wget -q -O $TMP_FOLDER/$folder.zip https://production-graphacademy-assets.s3.amazonaws.com/content/$folder.zip
   unzip -q -d $TMP_FOLDER/$folder $TMP_FOLDER/$folder.zip
done

echo "Copying courses"
cp -rf $TMP_FOLDER/courses/asciidoc/ $TARGET_FOLDER/asciidoc 2>/dev/null

echo "Overwriting certifications"
cp -rf $TMP_FOLDER/certifications/asciidoc/certifications/ $TARGET_FOLDER/asciidoc/certifications/ 2>/dev/null

echo "copying HTML"
cp -rf $TMP_FOLDER/html/ $TARGET_FOLDER 2>/dev/null

npm run $1

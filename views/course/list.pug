extends ../layouts/two-column
include ../course/card

mixin recurse(child, link='/categories')
  li.secondary-nav-item(class=`category--${child.slug} ${child.slug === slug ? 'secondary-nav-item--active' : ''}`)
    a(href=child.link) !{child.title}
      if child.courses.filter(course => course.status == 'active').length > 0
        | #{' '}(!{child.courses.filter(course => course.status == 'active').length})

    if child.children && child.children.length
      ul.secondary-nav-list
        for child in category.children
          +recurse(child)

block minor
  nav.secondary-nav.secondary-nav--collapsible
    h2.secondary-nav-title.body-small !{translate('browse-courses', 'Browse Courses')}

    //- .secondary-nav-group.secondary-nav-group--grouped
    //-   ul.secondary-nav-list

    //-     li.secondary-nav-item.secondary-nav-item--grouped(class=!slug ? 'secondary-nav-item--active' : '')
    //-       a(href='/categories/') !{translate('all-courses', 'All Courses')}
    //-     if user
    //-       li.secondary-nav-item.secondary-nav-item--grouped
    //-         a(href='/account/courses/') !{translate('my-courses', 'My Courses')}

    for category in categories
      if category.children.length
        div.secondary-nav-group(class=`category--${category.slug}`)
          h2.secondary-nav-header Browse By !{category.shortName || category.title}

          ul.secondary-nav-list
            for child in category.children
              +recurse(child)

      //- else
      //-   p.secondary-nav-group.secondary-nav-item.secondary-nav-item--grouped(class=slug === category.slug ? 'secondary-nav-item--active' : '')
      //-     a(href=category.link) !{category.title}

block major
  for group in grouped
    //- .course-group
    //-   if Object.keys(grouped).length > 1
    //-     h2.course-group-title !{group.name}
    //-     p.course-group-description !{group.description}

    .course-grid(class=group.name)
      if group && group.courses
        for course in group.courses
          .course-grid-item
            +course(course, course.categories[0])
